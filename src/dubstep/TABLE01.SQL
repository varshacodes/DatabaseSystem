CREATE TABLE PLAYERS(ID string, FIRSTNAME string, LASTNAME string, FIRSTSEASON int, LASTSEASON int, WEIGHT int, BIRTHDATE date);
CREATE TABLE R (A int, B int);
CREATE TABLE S (B int, C int);
CREATE TABLE T (C int, D int);
CREATE TABLE U (D int, E int);
CREATE TABLE V (E int, F int);
CREATE TABLE W (F int, G int);

CREATE TABLE LINEITEM(
  ORDERKEY INT,
  PARTKEY INT,
  SUPPKEY INT,
  LINENUMBER INT,
  QUANTITY DECIMAL,
  EXTENDEDPRICE DECIMAL,
  DISCOUNT DECIMAL,
  TAX DECIMAL,
  RETURNFLAG CHAR(1),
  LINESTATUS CHAR(1),
  SHIPDATE DATE,
  COMMITDATE DATE,
  RECEIPTDATE DATE,
  SHIPINSTRUCT CHAR(25),
  SHIPMODE CHAR(10),
  COMMENT VARCHAR(44),
  PRIMARY KEY (ORDERKEY, LINENUMBER),
  INDEX SHIPDATE (SHIPDATE),
  INDEX RECEIPTDATE (RECEIPTDATE),
  INDEX RETURNFLAG (RETURNFLAG));

CREATE TABLE ORDERS(
  ORDERKEY INT,
  CUSTKEY INT,
  ORDERSTATUS CHAR(1),
  TOTALPRICE DECIMAL,
  ORDERDATE DATE,
  ORDERPRIORITY CHAR(15),
  CLERK CHAR(15),
  SHIPPRIORITY INT,
  COMMENT VARCHAR(79),
  PRIMARY KEY (ORDERKEY),
  INDEX ORDERDATE (ORDERDATE));

CREATE TABLE PART(  PARTKEY INT,
  NAME VARCHAR(55),
  MFGR CHAR(25),
  BRAND CHAR(10),
  TYPE VARCHAR(25),
  SIZE INT,
  CONTAINER CHAR(10),
  RETAILPRICE DECIMAL,
  COMMENT VARCHAR(23),
  PRIMARY KEY (PARTKEY));

CREATE TABLE CUSTOMER(
  CUSTKEY INT,
  NAME VARCHAR(25),
  ADDRESS VARCHAR(40),
  NATIONKEY INT,
  PHONE CHAR(15),
  ACCTBAL DECIMAL,
  MKTSEGMENT CHAR(10),
  COMMENT VARCHAR(117),
  PRIMARY KEY (CUSTKEY),
  INDEX MKTSEGMENT (MKTSEGMENT));

CREATE TABLE SUPPLIER(
  SUPPKEY INT,
  NAME CHAR(25),
  ADDRESS VARCHAR(40),
  NATIONKEY INT,
  PHONE CHAR(15),
  ACCTBAL DECIMAL,
  COMMENT VARCHAR(101),
  PRIMARY KEY (SUPPKEY),
  INDEX NATIONKEY (NATIONKEY));


CREATE TABLE PARTSUPP(
  PARTKEY INT,
  SUPPKEY INT,
  AVAILQTY INT,
  SUPPLYCOST DECIMAL,
  COMMENT VARCHAR(199),
  PRIMARY KEY (PARTKEY, SUPPKEY));

CREATE TABLE NATION(
  NATIONKEY INT,
  NAME CHAR(25),
  REGIONKEY INT,
  COMMENT VARCHAR(152),
  PRIMARY KEY (NATIONKEY));

CREATE TABLE REGION(
  REGIONKEY INT,
  NAME CHAR(25),
  COMMENT VARCHAR(152),
  PRIMARY KEY (REGIONKEY));


SELECT SUM(A*D) FROM R, S, T WHERE (R.B = 2) AND (S.C = T.C);

SELECT R.A,SUM(A*D) FROM R, S, T WHERE (R.B = 2) AND (S.C = T.C) AND R.A >3 AND R.A > T.C group by R.A;


SELECT A, SUM(D) FROM R, S, T WHERE (R.B = S.B) AND (S.C = T.C) GROUP BY A;
SELECT R.B, SUM(A*C) FROM R, S WHERE R.B = S.B GROUP BY R.B;
SELECT A, SUM(A+B), AVG(C+B) FROM R, S WHERE R.B = S.B GROUP BY A;
SELECT R.B, SUM(A), AVG(C) FROM R, S WHERE R.B = S.B GROUP BY R.B;
SELECT A, SUM(C) FROM R, S WHERE R.B = S.B GROUP BY A;
SELECT A, R.B, SUM(C) FROM R, S WHERE R.B = S.B GROUP BY A, R.B;
SELECT R.B, SUM(A * C) FROM R, S WHERE R.B = S.B GROUP BY A, R.B, C;
SELECT A, COUNT(*) FROM R, S GROUP BY A;
SELECT A, R.B, COUNT(*) FROM R, S GROUP BY A, R.B;
SELECT A, R.B, C, COUNT(*) FROM R, S GROUP BY A, R.B, C;
SELECT A, COUNT(*) FROM R GROUP BY A;
SELECT A, B, COUNT(*) FROM R GROUP BY A,B;
SELECT A, MAX(B) FROM R GROUP BY A;
SELECT A, MIN(B) FROM R GROUP BY A;



SELECT AVG(A) FROM R;
SELECT MIN(A),MAX(A) FROM R;
SELECT MAX(A) FROM R;
SELECT COUNT(*) FROM R;
SELECT COUNT(*) FROM R, S;
SELECT COUNT(*) FROM R, S WHERE R.B = S.B;
SELECT SUM(A) FROM R, S WHERE R.B = S.B;
SELECT SUM(A), AVG(C) FROM R, S WHERE R.B = S.B;
SELECT SUM(A+B), AVG(C+B) FROM R, S WHERE R.B = S.B;
SELECT SUM(A*C) FROM R, S WHERE R.B = S.B;
SELECT SUM(A) FROM R;


SELECT * FROM R, S, T WHERE R.B = S.B;
SELECT * FROM R,S where R.A = S.B order by R.A;
SELECT * FROM R ORDER BY A;
select * from (SELECT LASTNAME, MAX(WEIGHT) FROM PLAYERS GROUP BY LASTNAME);
select * from (SELECT LASTNAME, MAX(WEIGHT) FROM PLAYERS WHERE WEIGHT > 250 GROUP BY LASTNAME) ORDER BY LASTNAME DESC LIMIT 10;
SELECT LASTNAME , MAX(WEIGHT) FROM PLAYERS GROUP BY LASTNAME;
SELECT FIRSTSEASON, COUNT(ID) FROM PLAYERS GROUP BY FIRSTSEASON;
SELECT EXPERIENCE, COUNT(*) FROM (SELECT ID, FIRSTNAME, LASTNAME, (LASTSEASON-FIRSTSEASON) AS EXPERIENCE FROM PLAYERS) GROUP BY EXPERIENCE order by EXPERIENCE desc;
select * from   R,S,T,U,V where R.B = S.B and S.C = T.C  order by R.A;
select * from (SELECT LASTNAME, MAX(WEIGHT) FROM PLAYERS GROUP BY LASTNAME) ORDER BY LASTNAME DESC LIMIT 10;

SELECT P1.*, P2.* FROM
(SELECT ID,FIRSTNAME,LASTNAME,FIRSTSEASON,LASTSEASON,WEIGHT,BIRTHDATE FROM PLAYERS ORDER BY ID LIMIT 100) P1,
(SELECT ID,FIRSTNAME,LASTNAME,FIRSTSEASON,LASTSEASON,WEIGHT,BIRTHDATE FROM PLAYERS ORDER BY ID LIMIT 100) P2
WHERE (P1.FIRSTSEASON<P2.FIRSTSEASON AND P1.LASTSEASON>P2.LASTSEASON);

SELECT LINEITEM.ORDERKEY, SUM(LINEITEM.EXTENDEDPRICE*(1-LINEITEM.DISCOUNT)) AS REVENUE, ORDERS.ORDERDATE,ORDERS.SHIPPRIORITY
FROM CUSTOMER, ORDERS,LINEITEM WHERE CUSTOMER.MKTSEGMENT = 'HOUSEHOLD' AND CUSTOMER.CUSTKEY = ORDERS.CUSTKEY
AND LINEITEM.ORDERKEY = ORDERS.ORDERKEY AND ORDERS.ORDERDATE < DATE('1995-03-29') AND LINEITEM.SHIPDATE > DATE('1995-03-29')
GROUP BY LINEITEM.ORDERKEY, ORDERS.ORDERDATE, ORDERS.SHIPPRIORITY
ORDER BY REVENUE DESC, ORDERDATE LIMIT 10;

SELECT LINEITEM.RETURNFLAG, LINEITEM.LINESTATUS, SUM(LINEITEM.QUANTITY) AS SUM_QTY, SUM(LINEITEM.EXTENDEDPRICE) AS SUM_BASE_PRICE, SUM(LINEITEM.EXTENDEDPRICE*(1-LINEITEM.DISCOUNT)) AS SUM_DISC_PRICE,SUM(LINEITEM.EXTENDEDPRICE*(1-LINEITEM.DISCOUNT)*(1+LINEITEM.TAX)) AS SUM_CHARGE,
AVG(LINEITEM.QUANTITY) AS AVG_QTY, AVG(LINEITEM.EXTENDEDPRICE) AS AVG_PRICE, AVG(LINEITEM.DISCOUNT) AS AVG_DISC, COUNT(*) AS COUNT_ORDER
FROM LINEITEM WHERE LINEITEM.SHIPDATE <= DATE('1999-02-25')
GROUP BY LINEITEM.RETURNFLAG, LINEITEM.LINESTATUS
ORDER BY LINEITEM.RETURNFLAG, LINEITEM.LINESTATUS;

SELECT LINEITEM.ORDERKEY,SUM(LINEITEM.EXTENDEDPRICE*(1-LINEITEM.DISCOUNT)) AS REVENUE, ORDERS.ORDERDATE, ORDERS.SHIPPRIORITY
FROM CUSTOMER, ORDERS, LINEITEM
WHERE CUSTOMER.MKTSEGMENT = 'BUILDING' AND CUSTOMER.CUSTKEY = ORDERS.CUSTKEY
AND LINEITEM.ORDERKEY = ORDERS.ORDERKEY
AND ORDERS.ORDERDATE < DATE('1995-03-04')
AND LINEITEM.SHIPDATE > DATE('1995-03-04')
GROUP BY LINEITEM.ORDERKEY, ORDERS.ORDERDATE, ORDERS.SHIPPRIORITY
ORDER BY REVENUE DESC, ORDERDATE LIMIT 10;

INSERT INTO LINEITEM(ORDERKEY, PARTKEY, SUPPKEY, LINENUMBER, QUANTITY, EXTENDEDPRICE, DISCOUNT, TAX, RETURNFLAG, LINESTATUS, SHIPDATE, COMMITDATE, RECEIPTDATE, SHIPINSTRUCT, SHIPMODE, COMMENT)
VALUES (6000151, 46793, 9293, 4, 19, 33056.01, 0.07, 0.04, 'N', 'O', {d'1999-01-28'}, {d'1999-04-24'}, {d'1999-02-04'}, 'COLLECT COD', 'RAIL', 'somas haggle silen');
INSERT INTO R(A,B) VALUES(12,25);
DELETE FROM LINEITEM WHERE ORDERKEY = 1499269;
INSERT INTO R(A,B) VALUES(412,25);
INSERT INTO R(A,B) VALUES(2,5);
INSERT INTO R(A,B) VALUES(32,25);
UPDATE CUSTOMER SET ACCTBAL = 0 WHERE CUSTKEY = 68290;